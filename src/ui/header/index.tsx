/* eslint-disable jsx-a11y/anchor-is-valid */
import {useEffect, useState, useContext} from 'react';
import { useNavigate } from "react-router-dom";
import { getData } from "../../utils";
import AppContext from "../../context/AppContext";

function Header() {
  const navigate = useNavigate();
  const [logged, setLogged] = useState(false);  
  const { state, setToken } = useContext(AppContext);
  
  const salir = () => {
    localStorage.removeItem("token"); 
    setToken("");
    navigate("/"); 
  }

  useEffect(() => {
        let token = getData("token");
        if(token!=="" && token!==null){
            setLogged(true);
        }
    }, [])
  useEffect(() => {
    let token = getData("token");
    if(state?.token === "" && token === null){
        setLogged(false);
    }
  }, [state]);

  return (
    <>
        <nav className="w-full top-0">
            <div className="w-full container mx-auto flex flex-wrap items-center justify-between mt-3 py-2">
                <div className="pl-4 md:pl-8 flex items-center">
                <a className="toggleColour text-white no-underline hover:no-underline font-bold text-2xl lg:text-4xl" href="#">
                    
                    <svg className="md:hidden" width="26" height="27" viewBox="0 0 26 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.6445 1.72514L24.4846 25.9287H11.8259V27H25.4192C25.7399 27 26 26.7619 26 26.4681C26 26.3876 25.98 26.3082 25.9416 26.2358L12.1824 0.299588C12.0422 0.0353775 11.6947 -0.0747664 11.4061 0.0535752C11.2932 0.10379 11.2011 0.18614 11.1436 0.288295L0.0646736 19.9688C-0.0823034 20.2299 0.0297011 20.5507 0.314843 20.6853C0.397139 20.7241 0.488383 20.7444 0.580968 20.7444H11.7965V19.6731H1.54091L11.6445 1.72514Z" fill="white"/>
                    </svg>
                    
                    <svg className="hidden md:block" width="133" height="25" viewBox="0 0 133 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M0 24.4036L9.1629 0.853413L18.3258 24.4036H14.9855L14.3113 22.5402H4.04516L3.34032 24.4036H0ZM5.14839 19.5522H13.1774L9.1629 8.75703L5.14839 19.5522ZM26.4468 0.885541V21.0944H35.6097V24.4679H23.1677V0.885541H26.4468ZM52.3726 0.885541H55.5903V16.6285C55.5903 17.7209 55.3911 18.7383 54.9927 19.6807C54.5944 20.6232 54.0479 21.4424 53.3532 22.1386C52.6586 22.8347 51.8516 23.3862 50.9323 23.7932C50.0129 24.2001 49.0221 24.4036 47.9597 24.4036C46.9177 24.4036 45.9422 24.2001 45.0331 23.7932C44.1239 23.3862 43.3272 22.8347 42.6427 22.1386C41.9583 21.4424 41.422 20.6232 41.0339 19.6807C40.6457 18.7383 40.4516 17.7209 40.4516 16.6285V0.885541H43.6694V16.6285C43.6694 17.2497 43.7817 17.8333 44.0065 18.3795C44.2312 18.9257 44.5376 19.4076 44.9258 19.8253C45.314 20.243 45.7737 20.5696 46.3048 20.8052C46.836 21.0408 47.3979 21.1586 47.9903 21.1586C48.6032 21.1586 49.1753 21.0408 49.7065 20.8052C50.2376 20.5696 50.7024 20.243 51.1008 19.8253C51.4992 19.4076 51.8108 18.9257 52.0355 18.3795C52.2602 17.8333 52.3726 17.2497 52.3726 16.6285V0.885541ZM71.679 0.917669H75.1726V0.949796L69.5339 12.6767L75.1726 24.4679V24.5H71.7097L67.7871 16.3394L63.8952 24.5H60.4323V24.4679L66.071 12.6767L60.4323 0.949796V0.917669H63.9258L67.7871 9.04619L71.679 0.917669ZM80.0145 24.4357V0.885541H83.2935V24.4357H80.0145ZM99.321 0.789158C100.874 0.789158 102.334 1.09972 103.703 1.72088C105.072 2.34203 106.262 3.18808 107.273 4.25904C108.285 5.32999 109.081 6.58835 109.664 8.03414C110.246 9.47993 110.537 11.0274 110.537 12.6767C110.537 14.3046 110.246 15.836 109.664 17.2711C109.081 18.7062 108.285 19.9592 107.273 21.0301C106.262 22.1011 105.072 22.9471 103.703 23.5683C102.334 24.1894 100.874 24.5 99.321 24.5C97.7683 24.5 96.3127 24.1894 94.954 23.5683C93.5954 22.9471 92.4105 22.1011 91.3992 21.0301C90.3879 19.9592 89.5911 18.7062 89.0089 17.2711C88.4266 15.836 88.1355 14.3046 88.1355 12.6767C88.1355 11.0274 88.4266 9.47993 89.0089 8.03414C89.5911 6.58835 90.3879 5.32999 91.3992 4.25904C92.4105 3.18808 93.5954 2.34203 94.954 1.72088C96.3127 1.09972 97.7683 0.789158 99.321 0.789158ZM99.321 21.2229C100.383 21.2229 101.39 20.998 102.34 20.5482C103.29 20.0984 104.117 19.488 104.822 18.7169C105.527 17.9458 106.083 17.0408 106.492 16.002C106.901 14.9632 107.105 13.8548 107.105 12.6767C107.105 11.4987 106.901 10.3849 106.492 9.33534C106.083 8.2858 105.527 7.37015 104.822 6.58835C104.117 5.80655 103.29 5.19076 102.34 4.74096C101.39 4.29116 100.383 4.06626 99.321 4.06626C98.2586 4.06626 97.2575 4.29116 96.3177 4.74096C95.378 5.19076 94.5556 5.80655 93.8508 6.58835C93.146 7.37015 92.5892 8.2858 92.1806 9.33534C91.772 10.3849 91.5677 11.4987 91.5677 12.6767C91.5677 13.8548 91.772 14.9632 92.1806 16.002C92.5892 17.0408 93.146 17.9458 93.8508 18.7169C94.5556 19.488 95.378 20.0984 96.3177 20.5482C97.2575 20.998 98.2586 21.2229 99.321 21.2229ZM118.474 9.6245V24.5H115.379V0.5L129.905 18.7169V0.917669H133V24.5H129.997L118.474 9.6245Z" fill="white"/>
                    </svg>
                </a>
                </div>
                { logged &&
                    <div className="w-full flex items-center w-auto mt-2 mt-0 bg-white bg-transparent text-black p-4 z-20" id="nav-content">
                        <ul className="list-reset flex justify-end flex-1 items-center text-base">
                            <li className="h-[25px]">
                                <a onClick={()=>{ navigate("/search") }} className="inline-block px-3 md:px-6 font-bold no-underline colorSecondary" href="#">Buscar</a>
                            </li>
                            <li className="h-[25px]">
                                <a onClick={()=>{ navigate("/albumes") }} className="inline-block px-3 md:px-6 text-white no-underline" href="#">Mis albumes</a>
                            </li>



                            <li className="h-[25px] border-l-2">
                                <svg onClick={()=>salir()} className="md:hidden mt-1 ml-1.5" width="24" height="19" viewBox="0 0 24 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M4.5 17.375H13.5C13.8977 17.3747 14.279 17.2561 14.5602 17.0452C14.8414 16.8343 14.9996 16.5483 15 16.25V14.5625H13.5V16.25H4.5V2.75H13.5V4.4375H15V2.75C14.9996 2.45172 14.8414 2.16575 14.5602 1.95483C14.279 1.74392 13.8977 1.6253 13.5 1.625H4.5C4.1023 1.6253 3.721 1.74392 3.43978 1.95483C3.15856 2.16575 3.0004 2.45172 3 2.75V16.25C3.0004 16.5483 3.15856 16.8343 3.43978 17.0452C3.721 17.2561 4.1023 17.3747 4.5 17.375Z" fill="white"/>
                                    <path d="M15.4395 12.0796L18.129 10.0625H7.5V8.9375H18.129L15.4395 6.92037L16.5 6.125L21 9.5L16.5 12.875L15.4395 12.0796Z" fill="white"/>
                                </svg>
                                <a className="hidden md:block inline-block px-6 text-white no-underline" 
                                    onClick={()=>salir()} href="#">Cerrar sesi√≥n</a>
                            </li>
                        </ul>
                    </div>
                }
            </div>
        </nav>
    </>
  );
}

export default Header;
